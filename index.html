<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Is-This-Gergi?</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
    <link rel="stylesheet" href="./app.css" />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
  </head>
  <body :class="{ 'dark': darkMode }" x-data="app()" x-init="init()">
    <div class="container">
      <div class="search">
        <input
          id="search-input"
          type="text"
          placeholder="&#xF002; TODO: search has no real use case yet"
          x-model="searchTerm"
          @input="filterMenu"
        />
          <!-- 'X' button to clear the search input -->
        <button
          class="clear-button"
          @click="clearSearch"
          x-show="searchTerm.length > 0"
          x-transition:enter.duration.0ms
          x-transition:leave.duration.0ms
          aria-label="Clear search input"
        >
          &#x2716; <!-- Unicode for 'X' symbol -->
        </button>
        <button class="dark-mode-button" @click="toggleDarkMode()">
          <i
            class="fa fa-moon-o"
            aria-hidden="true"
            x-show="darkMode"
            x-transition:enter.duration.300ms
            x-transition:leave.duration.0ms
          ></i>
          <i
            class="fa fa-sun-o"
            aria-hidden="true"
            x-show="!darkMode"
            x-transition:enter.duration.300ms
            x-transition:leave.duration.0ms
          ></i>
        </button>
      </div>
      <span
        class="sub-comment"
        x-show="searchTerm.length > 0"
        x-transition:enter.duration.300ms
        x-transition:leave.duration.300ms
      >
        press [ESC] to cancel
      </span>
      <div class="main-container">
        <div class="menu">
          <a
            href="#"
            :class="{'inactive': !isVisible('home'), 'active': currentPage === 'home'}"
            @click.prevent="setPage('home')"
          >
            home
          </a>
          <a
            href="#"
            :class="{'inactive': !isVisible('text'), 'active': currentPage === 'text'}"
            @click.prevent="setPage('text')"
          >
            text
          </a>
          <a
            href="#"
            :class="{'inactive': !isVisible('terminal'), 'active': currentPage === 'terminal'}"
            @click.prevent="setPage('terminal')"
          >
            terminal
          </a>
          <a
            href="#"
            :class="{'inactive': !isVisible('keyboard'), 'active': currentPage === 'keyboard'}"
            @click.prevent="setPage('keyboard')"
          >
            keyboard
          </a>
        </div>

        <div class="content">
          <div
            x-show="currentPage === 'home'"
            x-transition
            x-transition:enter.duration.500ms
            x-transition:leave.duration.400ms
          >
            <h1>Gergely, Horv√°th</h1>
            <h5>
              <i class="fa fa-laptop" aria-hidden="true"></i>
              WEB-/SOFTWARE DEVELOPER
              <i class="fa fa-code" aria-hidden="true"></i>
            </h5>
            <p class="justified">
              A minimalistic page for a brief introduction to my profile, and a little playground of mine.
            </p>
          </div>

          <div
            x-show="currentPage === 'text'"
            x-transition
            x-transition:enter.duration.500ms
            x-transition:leave.duration.400ms
            x-cloak
          >
            <h2>About</h2>
            <div class="about-container">
              <div class="portrait-container">
                <img src="./g.jpg" alt="Portrait" class="portrait-image" />
              </div>
              <p class="justified about-text" x-html="aboutDescription"></p>
            </div>
            <h2>Career</h2>
            <p class="justified" x-html="careerDescription"></p>
            <h2>Links</h2>
            <p class="justified">
                <ul class="links-list">
                    <template x-for="lnk in links">
                        <li>
                            <a x-bind:href="lnk[1]" x-html="lnk[0]" class="link" target="_blank"></a>
                        </li>
                    </template>
                </ul>
            </p>
          </div>

          <div
            x-show="currentPage === 'terminal'"
            x-transition
            x-transition:enter.duration.500ms
            x-transition:leave.duration.400ms
            x-cloak
          >
            <div class="terminal-container">
              <ul class="terminal-lines-list">
                <template x-for="line in terminalLines">
                  <li x-html="line"></li>
                </template>
              </ul>
              <div class="terminal-input-container">
                <span class="terminal-input-arrow">></span>
                <input
                  type="text"
                  class="terminal-input"
                  placeholder="Type 'help' for available commands..."
                  x-model="commandInput"
                  @keydown.enter.prevent="handleCommand"
                />
              </div>
            </div>
          </div>

          <div
            x-show="currentPage === 'keyboard'"
            x-transition
            x-transition:enter.duration.500ms
            x-transition:leave.duration.400ms
            x-cloak
          >
            Coming soon... (soon? you sure?)
          </div>
        </div>
      </div>
    </div>

    <script>
      const pageTags = {
        home: ["home"],
        text: ["text", "about", "career", "links", "github", "linkedin"],
        terminal: ["terminal", "about", "links", "github", "linkedin"],
        keyboard: ["keyboard", "coming soon"]
      };
      const age = new Date().getFullYear() - 1990;
      const careerAge = new Date().getFullYear() - 2016;
      const emojiTexts = {
        old: ["old", "&#x1F9D3;"],
        hungary: ["Hungary", "&#x1F1ED;&#x1F1FA;"],
        it: ["IT", "&#x1F4BB;"],
      };
      // Could be a dictionary/map if more attributes are needed, like 'isOpenSource' or something
      const links = [
        ["&#xf09b; GitHub", "https://github.com/GergiH/"],
        ["&#xf0e1; LinkedIn", "https://www.linkedin.com/in/gergi-hrv/"],
        ["&#xf233; IFRC Go - API (contributor)", "https://github.com/IFRCGo/go-api/"],
        ["&#xf13b; IFRC Go - Frontend (contributor)", "https://github.com/IFRCGo/go-frontend/"],
        ["&#xf11c; Old terminal personal page", "https://gergih.github.io/portfolio-terminal/"]
      ];

      function app() {
        return {
          transitionRun: 0,
          transitionDone: true,
          currentPage: "home",
          searchTerm: "",
          darkMode: false,
          isEmoji: true,
          terminalLines: [],
          commandInput: "",
          descriptions: {
            about(old, flag) {
              return `A <strong>${age} years</strong> ${old} software developer from ${flag}. Basically interested in any topic, just to name a few: programming (obviously), cooking, fitness, astrology, languages, psychology. When not coding, he's either watching random animal videos, gaming, having a drink with friends, or watching sports.`;
            },
            career(it) {
              return `<strong>${careerAge} years</strong> of ${it} experience, mainly developing web applications, web services, console applications, REST APIs - using the following languages, frameworks, tools (stronger to weaker + tools): C#, .NET (v4.5 -> current), JavaScript, Python, MSSQL, Blazor, PostgreSQL, React, Django, TypeScript, Angular, Vue, Visual Studio, VSCode, Vim, GitHub, TFS, Azure DevOps.`;
            },
          },
          setPage(page) {
            this.currentPage = page;
            this.isEmoji = page !== "terminal";
          },
          get aboutDescription() {
            // Need to handle emoji texts here because 'this' has a different scope inside the 'descriptions' functions
            const old = this.isEmoji
              ? emojiTexts.old[1]
              : emojiTexts.old[0];
            const flag = this.isEmoji
              ? emojiTexts.hungary[1]
              : emojiTexts.hungary[0];
            return this.descriptions.about(old, flag);
          },
          get careerDescription() {
            const it = this.isEmoji
              ? emojiTexts.it[1]
              : emojiTexts.it[0];
            return this.descriptions.career(it);
          },
          get linksForTerminal() {
            let html = "<ul>";
            links.forEach(link => {
              html += `<li><a href="${link[1]}" target="_blank">${link[0]}</a></li>`;
            });
            html += "</ul>";

            return html;
          },
          // Method to handle terminal commands
          handleCommand() {
            const command = this.commandInput.trim();

            if (command === "clear") {
              this.terminalLines = [];
            } else if (command) {
              // Add the command to the terminal and simulate a response
              this.terminalLines.push(`> ${command}`);
              this.processCommand(command); // Handle other commands
            }

            this.commandInput = ""; // Clear the input field
          },
          // Method to simulate processing various commands
          processCommand(command) {
            switch (command) {
              case "help":
                this.terminalLines.push("Available commands: about, career, links, help, clear");
                break;
              case "about":
                this.terminalLines.push(this.aboutDescription);
                break;
              case "career":
                this.terminalLines.push(this.careerDescription);
                break;
              case "links":
                this.terminalLines.push(this.linksForTerminal);
                break;
              default:
                this.terminalLines.push(`Unknown command: ${command}`);
            }
          },
          isVisible(page) {
            // Check if any tag for the page includes the current search term
            const tags = pageTags[page] || [];
            return tags.some((tag) =>
              tag.includes(this.searchTerm.toLowerCase())
            );
          },
          filterMenu() {
            // This function can be expanded if needed
            console.log(`Filtering menu for: ${this.searchTerm}`); // Log the current search term
          },
          clearSearch() {
            this.searchTerm = "";
          },
          toggleDarkMode() {
            this.darkMode = !this.darkMode;
          },
          init() {
            if (
              window.matchMedia &&
              window.matchMedia("(prefers-color-scheme: dark)").matches
            ) {
              this.darkMode = true;
            }
            // Add global keydown event listener
            document.addEventListener("keydown", (event) => {
              if (event.key === "Escape") {
                this.clearSearch(); // Clear search input on ESC key press
              }
            });
          },
        };
      }
    </script>
  </body>
</html>
